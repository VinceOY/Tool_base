disease_codes = list("E08","E09","E10","E11","E12"),
# dt1 parameters
clinic_parameters = list(
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3),
# dt2 parameters
hospital_parameters = list(
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1)
)
# for all datasets
folder_path <- parameters$folder_path
disease_codes <- unlist(parameters$disease_codes)
# 存取 dt1 的參數
dt1_file_list <- unlist(parameters$clinic_parameters$file_list)
dt1_target_ID_cols <- unlist(parameters$clinic_parameters$target_ID_cols)
dt1_disease_ID_cols <- unlist(parameters$clinic_parameters$disease_ID_cols)
dt1_date_col <- unlist(parameters$clinic_parameters$date_col)
dt1_df_name <- unlist(parameters$clinic_parameters$df_name)
dt1_group_id <- unlist(parameters$clinic_parameters$group_id)
dt1_valid_times <- unlist(parameters$clinic_parameters$k)
# 存取 dt2 的參數
dt2_file_list <- unlist(parameters$hospital_parameters$file_list)
dt2_target_ID_cols <- unlist(parameters$hospital_parameters$target_ID_cols)
dt2_disease_ID_cols <- unlist(parameters$hospital_parameters$disease_ID_cols)
dt2_date_col <- unlist(parameters$hospital_parameters$date_col)
dt2_df_name <- unlist(parameters$hospital_parameters$df_name)
dt2_group_id <- unlist(parameters$hospital_parameters$group_id)
dt2_valid_times <- unlist(parameters$hospital_parameters$k)
# step1: fetch data
dt_c <- data.table()
for (i in dt1_file_list) {
d_tmp <- fread(paste0(folder_path,i))
d_tmp <- fetch_data(d_tmp, dt1_target_ID_cols, dt1_disease_ID_cols, disease_codes)
dt_c <- rbind(dt_c, d_tmp)
}
# get hospital valid data
dt_hos <- data.table()
for (i in dt2_file_list) {
d_tmp <- fread(paste0(folder_path,i))
d_tmp <- fetch_data(d_tmp, dt2_target_ID_cols, dt2_disease_ID_cols, disease_codes)
dt_hos <- rbind(dt_hos, d_tmp)
}
# step2: standard date
dt_c <- standardized_date(dt_c, dt1_date_col)
dt_hos <- standardized_date(dt_hos, dt2_date_col)
dt_hos
dt_c
# step3: find earliest date for each id
P_list <- list(
list(df = dt1_df_name, idcol = dt1_group_id, datecol = dt1_date_col, k = dt1_valid_times),
list(df = dt2_df_name, idcol = dt2_group_id, datecol = dt2_date_col, k = dt2_valid_times)
)
clean_dt <- find_earliest_date(P_list)
clean_dt
# 定義參數列表
parameters <- list(
# files
folder_path = "C:/Users/USER/Downloads/hospital/TMUCRD_2021_csv_new/",
disease_codes = list("E08","E09","E10","E11","E12"),
total_type_data = 2,
# dt1 parameters
clinic_parameters = list(
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3),
# dt2 parameters
hospital_parameters = list(
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1)
)
# for all datasets
folder_path <- parameters$folder_path
disease_codes <- unlist(parameters$disease_codes)
num_data <-  unlist(parameters$total_type_data)
num_data
#
for (i in 1:num_data) {
print(i)
}
new_dir <- "C:/Users/USER/Downloads/function_tool/"
setwd(new_dir)
source("tool_function/fetch_function.R")
source("tool_function/standard_function.R")
# 定義參數列表
parameters <- list(
# files
folder_path = "C:/Users/USER/Downloads/hospital/TMUCRD_2021_csv_new/",
disease_codes = list("E08","E09","E10","E11","E12"),
# data sets parameters
data_sets = list(
list(
# dt1 parameters
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3
),
list(
# dt2 parameters
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1
)
)
)
for (data_set in parameters$data_sets) {
dt_file_list <- unlist(data_set$file_list)
dt_target_ID_cols <- unlist(data_set$target_ID_cols)
dt_disease_ID_cols <- unlist(data_set$disease_ID_cols)
dt_date_col <- unlist(data_set$date_col)
dt_df_name <- unlist(data_set$df_name)
dt_group_id <- unlist(data_set$group_id)
dt_valid_times <- unlist(data_set$k)
}
dt_file_list
dt_target_ID_cols
new_dir <- "C:/Users/USER/Downloads/function_tool/"
setwd(new_dir)
source("tool_function/fetch_function.R")
source("tool_function/standard_function.R")
# 定義參數列表
parameters <- list(
# files
folder_path = "C:/Users/USER/Downloads/hospital/TMUCRD_2021_csv_new/",
disease_codes = list("E08","E09","E10","E11","E12"),
# data sets parameters
data_sets = list(
list(
# dt1 parameters
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3
),
list(
# dt2 parameters
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1
)
)
)
#
P_list = list()
folder_path <- unlist(parameters$folder_path)
disease_codes <- unlist(parameters$disease_codes)
for (data_set in parameters$data_sets) {
dt_file_list <- unlist(data_set$file_list)
dt_target_ID_cols <- unlist(data_set$target_ID_cols)
dt_disease_ID_cols <- unlist(data_set$disease_ID_cols)
dt_date_col <- unlist(data_set$date_col)
dt_df_name <- unlist(data_set$df_name)
dt_group_id <- unlist(data_set$group_id)
dt_valid_times <- unlist(data_set$k)
# step1: fetch data
dt_f <- data.table()
for (file in dt_file_list) {
d_tmp <- fread(paste0(folder_path, file))
d_tmp <- fetch_data(d_tmp, dt_target_ID_cols, dt_disease_ID_cols, disease_codes)
dt_f <- rbind(dt_f, d_tmp)
}
# step2: standard date
dt_f <- standardized_date(dt_f, dt_date_col)
}
new_dir <- "C:/Users/USER/Downloads/function_tool/"
setwd(new_dir)
source("tool_function/fetch_function.R")
source("tool_function/standard_function.R")
# 定義參數列表
parameters <- list(
# files
folder_path = "C:/Users/USER/Downloads/hospital/TMUCRD_2021_csv_new/",
disease_codes = list("E08","E09","E10","E11","E12"),
# data sets parameters
data_sets = list(
list(
# dt1 parameters
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3
),
list(
# dt2 parameters
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1
)
)
)
P_list = list()
folder_path <- unlist(parameters$folder_path)
disease_codes <- unlist(parameters$disease_codes)
for (data_set in parameters$data_sets) {
dt_file_list <- unlist(data_set$file_list)
dt_target_ID_cols <- unlist(data_set$target_ID_cols)
dt_disease_ID_cols <- unlist(data_set$disease_ID_cols)
dt_date_col <- unlist(data_set$date_col)
dt_df_name <- unlist(data_set$df_name)
dt_group_id <- unlist(data_set$group_id)
dt_valid_times <- unlist(data_set$k)
dt_f_name <- unlist(data_set$df_name)
# step1: fetch data
assign(dt_f_name, data.table())
dt_f <- get(dt_f_name)
dt_f <- data.table()
for (file in dt_file_list) {
d_tmp <- fread(paste0(folder_path, file))
d_tmp <- fetch_data(d_tmp, dt_target_ID_cols, dt_disease_ID_cols, disease_codes)
dt_f <- rbind(dt_f, d_tmp)
}
# step2: standard date
dt_f <- standardized_date(dt_f, dt_date_col)
# step3: create find_earliest_date parameters
P_list <- append(P_list, list(df = dt_f_name, idcol = dt_group_id, datecol = dt_date_col, k = dt_valid_times))
}
P_list
P_list[1]
parameters$data_sets
clean_dt <- find_earliest_date(P_list)
new_dir <- "C:/Users/USER/Downloads/function_tool/"
setwd(new_dir)
source("tool_function/fetch_function.R")
source("tool_function/standard_function.R")
# 定義參數列表
parameters <- list(
# files
folder_path = "C:/Users/USER/Downloads/hospital/TMUCRD_2021_csv_new/",
disease_codes = list("E08","E09","E10","E11","E12"),
# data sets parameters
data_sets = list(
list(
# dt1 parameters
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3
),
list(
# dt2 parameters
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1
)
)
)
P_list = list()
folder_path <- unlist(parameters$folder_path)
disease_codes <- unlist(parameters$disease_codes)
for (data_set in parameters$data_sets) {
dt_file_list <- unlist(data_set$file_list)
dt_target_ID_cols <- unlist(data_set$target_ID_cols)
dt_disease_ID_cols <- unlist(data_set$disease_ID_cols)
dt_date_col <- unlist(data_set$date_col)
dt_df_name <- unlist(data_set$df_name)
dt_group_id <- unlist(data_set$group_id)
dt_valid_times <- unlist(data_set$k)
dt_f_name <- unlist(data_set$df_name)
# step1: fetch data
assign(dt_f_name, data.table())
dt_f <- get(dt_f_name)
dt_f <- data.table()
for (file in dt_file_list) {
d_tmp <- fread(paste0(folder_path, file))
d_tmp <- fetch_data(d_tmp, dt_target_ID_cols, dt_disease_ID_cols, disease_codes)
dt_f <- rbind(dt_f, d_tmp)
}
# step2: standard date
dt_f <- standardized_date(dt_f, dt_date_col)
# step3: create find_earliest_date parameters
P_list <- append(P_list, list(list(df = dt_f_name, idcol = dt_group_id, datecol = dt_date_col, k = dt_valid_times)))
}
P_list
clean_dt <- find_earliest_date(P_list)
df <- get(P[1]$df)
df
P[1]
P[1]$df
get(P[1]$df)
new_dir <- "C:/Users/USER/Downloads/function_tool/"
setwd(new_dir)
source("tool_function/fetch_function.R")
source("tool_function/standard_function.R")
# 定義參數列表
parameters <- list(
# files
folder_path = "C:/Users/USER/Downloads/hospital/TMUCRD_2021_csv_new/",
disease_codes = list("E08","E09","E10","E11","E12"),
# data sets parameters
data_sets = list(
list(
# dt1 parameters
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3
),
list(
# dt2 parameters
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1
)
)
)
P_list = list()
folder_path <- unlist(parameters$folder_path)
disease_codes <- unlist(parameters$disease_codes)
for (data_set in parameters$data_sets) {
dt_file_list <- unlist(data_set$file_list)
dt_target_ID_cols <- unlist(data_set$target_ID_cols)
dt_disease_ID_cols <- unlist(data_set$disease_ID_cols)
dt_date_col <- unlist(data_set$date_col)
dt_df_name <- unlist(data_set$df_name)
dt_group_id <- unlist(data_set$group_id)
dt_valid_times <- unlist(data_set$k)
dt_f_name <- unlist(data_set$df_name)
# step1: fetch data
assign(dt_f_name, data.table())
dt_f_name <- get(dt_f_name)
dt_f <- data.table()
for (file in dt_file_list) {
d_tmp <- fread(paste0(folder_path, file))
d_tmp <- fetch_data(d_tmp, dt_target_ID_cols, dt_disease_ID_cols, disease_codes)
dt_f_name <- rbind(dt_f_name, d_tmp)
}
# step2: standard date
dt_f_name <- standardized_date(dt_f_name, dt_date_col)
# step3: create find_earliest_date parameters
P_list <- append(P_list, list(list(df = dt_f_name, idcol = dt_group_id, datecol = dt_date_col, k = dt_valid_times)))
}
d1 <- get(P[1]$df)
d1
dt_f_name
dt_f_name <- unlist(data_set$df_name)
dt_f_name
new_dir <- "C:/Users/USER/Downloads/function_tool/"
setwd(new_dir)
source("tool_function/fetch_function.R")
source("tool_function/standard_function.R")
# 定義參數列表
parameters <- list(
# files
folder_path = "C:/Users/USER/Downloads/hospital/TMUCRD_2021_csv_new/",
disease_codes = list("E08","E09","E10","E11","E12"),
# data sets parameters
data_sets = list(
list(
# dt1 parameters
file_list = list("v_opd_basic_w.csv","v_opd_basic_t.csv","v_opd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "OPD_DATE"),
disease_ID_cols = list("ICD9_CODE1", "ICD9_CODE2", "ICD9_CODE3", "ICD10_CODE1",
"ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4", "ICD10_CODE5",
"OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3"),
date_col = "OPD_DATE",
df_name = "dt_c",
group_id = "CHR_NO",
k = 3
),
list(
# dt2 parameters
file_list = list("v_ipd_basic_w.csv","v_ipd_basic_t.csv","v_ipd_basic_s.csv"),
target_ID_cols = list("CHR_NO", "IPD_DATE"),
disease_ID_cols = list("OP_CODE1", "OP_CODE2", "OP_CODE3", "OP_CODE4",
"OP_CODE5", "OPER10_CODE1", "OPER10_CODE2", "OPER10_CODE3",
"OPER10_CODE4", "OPER10_CODE5", "EDIAG_CODE", "ESDIAG_CODE1",
"ESDIAG_CODE2", "ESDIAG_CODE3", "ESDIAG_CODE4", "EDIAG_DESC",
"ICD10_CODE1", "ICD10_CODE2", "ICD10_CODE3", "ICD10_CODE4",
"ICD10_CODE5", "ICD10_CODE6", "ICD10_CODE7"),
date_col = "IPD_DATE",
df_name = "dt_hos",
group_id = "CHR_NO",
k = 1
)
)
)
P_list = list()
folder_path <- unlist(parameters$folder_path)
disease_codes <- unlist(parameters$disease_codes)
for (data_set in parameters$data_sets) {
dt_file_list <- unlist(data_set$file_list)
dt_target_ID_cols <- unlist(data_set$target_ID_cols)
dt_disease_ID_cols <- unlist(data_set$disease_ID_cols)
dt_date_col <- unlist(data_set$date_col)
dt_df_name <- unlist(data_set$df_name)
dt_group_id <- unlist(data_set$group_id)
dt_valid_times <- unlist(data_set$k)
dt_f_name <- unlist(data_set$df_name)
P_list <- append(P_list, list(list(df = dt_f_name, idcol = dt_group_id,
datecol = dt_date_col, k = dt_valid_times)))
# step1: fetch data
assign(dt_f_name, data.table())
dt_f_name <- get(dt_f_name)
dt_f <- data.table()
for (file in dt_file_list) {
d_tmp <- fread(paste0(folder_path, file))
d_tmp <- fetch_data(d_tmp, dt_target_ID_cols, dt_disease_ID_cols, disease_codes)
dt_f_name <- rbind(dt_f_name, d_tmp)
}
# step2: standard date
dt_f_name <- standardized_date(dt_f_name, dt_date_col)
}
d1 <- get(P[1]$df)
d1
dt_f_name
P_list
P[1]$df
P
